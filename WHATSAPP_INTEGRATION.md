# ุชูุงูู WhatsApp OTP - SMS Mobile API

## โ ุญุงูุฉ ุงูุชูุงูู: ุฌุงูุฒ ููุงุฎุชุจุงุฑ

ุชู ุชูุงูู ุฎุฏูุฉ SMS Mobile API ูุฅุฑุณุงู ุฑููุฒ ุงูุชุญูู (OTP) ุนุจุฑ ูุงุชุณุงุจ ุนูุฏูุง ููุณู ุงููุณุชุฎุฏููู ูููุฉ ุงููุฑูุฑ.

---

## ๐ ุงูููููุงุช ุงููุถุงูุฉ

### 1. ุฎุฏูุฉ WhatsApp (`server/services/whatsapp.ts`)
ุฎุฏูุฉ ุฌุฏูุฏุฉ ุชุชุนุงูู ูุน ุฅุฑุณุงู ุงูุฑุณุงุฆู ุนุจุฑ SMS Mobile API:
- โ ุฅุฑุณุงู ุฑููุฒ OTP ุนุจุฑ ูุงุชุณุงุจ
- โ ุชูุณูู ุชููุงุฆู ูุฃุฑูุงู ุงูููุงุชู ุงูููุจูุฉ (+218)
- โ ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก ูุน fallback ููุชุทููุฑ
- โ ุฏุนู ูุงูู ูููุตูุต ุงูุนุฑุจูุฉ

### 2. ุงูุชูุงูู ูุน ูุธุงู ูุณูุงู ูููุฉ ุงููุฑูุฑ
ุชู ุชุญุฏูุซ `server/routers/customer.ts`:
- โ ุงุณุชุจุฏุงู console.log mock ุจุฅุฑุณุงู ูุนูู ุนุจุฑ ูุงุชุณุงุจ
- โ ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก ุงูุฐููุฉ
- โ ุฑุณุงุฆู ูุงุถุญุฉ ุจุงูุนุฑุจูุฉ

---

## ๐ ุทุฑููุฉ ุงูุฅุนุฏุงุฏ ุงูุณุฑูุน

### ุงูุฎุทูุฉ 1: ุฅุถุงูุฉ ุงููุชุบูุฑุงุช ุงูุจูุฆูุฉ ุฅูู `.env`

ุงูุชุญ ููู `.env` ูุฃุถู ุงููุชุบูุฑุงุช ุงูุชุงููุฉ:

```env
# WhatsApp API Configuration - SMS Mobile API
WHATSAPP_API_KEY=ba56c204a8efb9ac88ae2a4c4b298d745f347323a66be590
WHATSAPP_ACCOUNT_ID=617a2b
WHATSAPP_ACCOUNT_LICENCE=335229047
WHATSAPP_BASE_URL=https://api.smsmobileapi.com
```

### ุงูุฎุทูุฉ 2: ุฅุนุงุฏุฉ ุชุดุบูู ุงูุฎุงุฏู

```bash
# ุฃููู ุงูุฎุงุฏู ุงูุญุงูู (Ctrl+C)
# ุซู ุดุบูู ูุฑุฉ ุฃุฎุฑู
npm run dev
```

### ุงูุฎุทูุฉ 3: ุงูุงุฎุชุจุงุฑ

1. ุงูุชุญ ุตูุญุฉ "ูุณูุช ูููุฉ ุงููุฑูุฑ" ุนูู ุงููููุน
2. ุฃุฏุฎู ุฑูู ูุงุชู ูุณุฌู
3. ุงุถุบุท ุนูู "ุฅุฑุณุงู ุงูุฑูุฒ"
4. ูุฌุจ ุฃู ุชุณุชูู ุฑุณุงูุฉ ูุงุชุณุงุจ ุชุญุชูู ุนูู ุฑูุฒ OTP

---

## ๐ฑ ููู ูุนูู ุงููุธุงูุ

### ุณูุฑ ุงูุนูู ุงููุงูู:

1. **ุงููุณุชุฎุฏู ููุณู ูููุฉ ุงููุฑูุฑ**
   - ูุฐูุจ ุฅูู ุตูุญุฉ "ูุณูุช ูููุฉ ุงููุฑูุฑ"
   - ูุฏุฎู ุฑูู ูุงุชูู

2. **ุงููุธุงู ูููุฏ OTP**
   - ูุชู ุชูููุฏ ุฑูุฒ ุนุดูุงุฆู ูู 6 ุฃุฑูุงู
   - ูุชู ุชุดููุฑู ุจู bcrypt ูุญูุธู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
   - ุตูุงุญูุฉ ุงูุฑูุฒ: 10 ุฏูุงุฆู

3. **ุฅุฑุณุงู ุนุจุฑ ูุงุชุณุงุจ**
   - ูุชู ุชูุณูู ุฑูู ุงููุงุชู ุชููุงุฆูุงู (+218 ูููุจูุง)
   - ุฅุฑุณุงู ุงูุฑุณุงูุฉ ุนุจุฑ SMS Mobile API
   - ุงูุฑุณุงูุฉ ุจุงููุบุฉ ุงูุนุฑุจูุฉ ูุน ุงูุฑููุฒ ุงูุชุนุจูุฑูุฉ ๐

4. **ุงููุณุชุฎุฏู ูุชุญูู**
   - ูุณุชูู ุงูุฑุณุงูุฉ ุนูู ูุงุชุณุงุจ
   - ูุฏุฎู ุงูุฑูุฒ ูู ุงูุตูุญุฉ
   - ูุชู ุงูุชุญูู ูู ุตุญุฉ ุงูุฑูุฒ

5. **ุชุบููุฑ ูููุฉ ุงููุฑูุฑ**
   - ุจุนุฏ ุงูุชุญูู ุงููุงุฌุญ
   - ูููู ุฅุฏุฎุงู ูููุฉ ูุฑูุฑ ุฌุฏูุฏุฉ
   - ูุชู ุญุฐู OTP ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช

---

## ๐ง ุงูุชูุงุตูู ุงูุชูููุฉ

### ุจููุฉ ุงูู API Request

```
GET https://api.smsmobileapi.com/sendsms?recipients=218XXXXXXXXX&message=...&apikey=...&send_wa=yes&account_id=...&account_licence=...
```

### ูุนุงููุงุช ุงูุทูุจ:
- `recipients`: ุฑูู ุงููุงุชู ุจุตูุบุฉ ุฏูููุฉ ุจุฏูู + ุฃู 00
- `message`: ูุต ุงูุฑุณุงูุฉ (ูุฏุนู ุงูุนุฑุจูุฉ ูุงูุฑููุฒ ุงูุชุนุจูุฑูุฉ)
- `apikey`: ููุชุงุญ ุงูู API ุงูุฎุงุต ุจู
- `send_wa`: `yes` ูุฅุฑุณุงู ุนุจุฑ ูุงุชุณุงุจ
- `account_id`: ูุนุฑู ุงูุญุณุงุจ
- `account_licence`: ุฑุฎุตุฉ ุงูุญุณุงุจ

### ูุต ุงูุฑุณุงูุฉ ุงูููุฑุณูุฉ:
```
๐ ุฑูุฒ ุงูุชุญูู ุงูุฎุงุต ุจู ูู: 123456

โ ุงูุฑูุฒ ุตุงูุญ ููุฏุฉ 10 ุฏูุงุฆู.
โ๏ธ ูุง ุชุดุงุฑู ูุฐุง ุงูุฑูุฒ ูุน ุฃู ุดุฎุต.
```

---

## ๐ก๏ธ ุงูุฃูุงู

- โ **ุชุดููุฑ OTP**: ุฌููุน ุฑููุฒ OTP ูุดูุฑุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุจุงุณุชุฎุฏุงู bcrypt
- โ **ุงูุชูุงุก ุงูุตูุงุญูุฉ**: ุฑููุฒ OTP ุชูุชูู ุตูุงุญูุชูุง ุจุนุฏ 10 ุฏูุงุฆู
- โ **ุงุณุชุฎุฏุงู ูุงุญุฏ**: ูุชู ุญุฐู OTP ุจุนุฏ ุงุณุชุฎุฏุงูู
- โ **ุชูุณูู ุขูู**: ุชูุณูู ุชููุงุฆู ูุฃุฑูุงู ุงูููุงุชู ูููุน ุงูุฃุฎุทุงุก
- โ **ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก**: ูุง ูุชู ุงููุดู ุนู ูุนูููุงุช ุญุณุงุณุฉ ูู ุฑุณุงุฆู ุงูุฎุทุฃ

---

## ๐งช ุงุฎุชุจุงุฑ ูู ุจูุฆุฉ ุงูุชุทููุฑ

ุฅุฐุง ูู ูุชู ุชูููู ุงููุชุบูุฑุงุช ุงูุจูุฆูุฉุ ุงููุธุงู ุณูุนูู ูู "ูุถุน ุงูุชุทููุฑ":
- โ๏ธ ุณูุธูุฑ ุชุญุฐูุฑ: "WhatsApp Service not configured"
- ๐ ุณูุชู ุทุจุงุนุฉ ุฑูุฒ OTP ูู console ููุงุฎุชุจุงุฑ
- โ ุจุงูู ุงููุธุงู ุณูุนูู ุจุดูู ุทุจูุนู

```
[WhatsApp] Service not configured. OTP for 0912345678: 123456
```

---

## ๐ ุชุชุจุน ููุฑุงูุจุฉ

ุฌููุน ุนูููุงุช ุฅุฑุณุงู OTP ูุชู ุชุณุฌูููุง ูู console:

### ูู ุญุงูุฉ ุงููุฌุงุญ:
```
[WhatsApp] Sending OTP to 218912345678...
[WhatsApp] โ OTP sent successfully to 218912345678
[WhatsApp] Response: { success: true, ... }
```

### ูู ุญุงูุฉ ุงููุดู:
```
[WhatsApp] Failed to send OTP. Status: 400
[WhatsApp] Error: Invalid API key
[WhatsApp FALLBACK] OTP for testing: 123456
```

---

## ๐ ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ุงููุดููุฉ: "WhatsApp service not configured"
**ุงูุญู**: ุชุฃูุฏ ูู ุฅุถุงูุฉ ุฌููุน ุงููุชุบูุฑุงุช ุงูุจูุฆูุฉ ุฅูู `.env`

### ุงููุดููุฉ: "Failed to send WhatsApp message"
**ุงูุญููู ุงููุญุชููุฉ**:
1. ุชุญูู ูู ุตุญุฉ API Key
2. ุชุฃูุฏ ูู ุตุญุฉ Account ID ู Licence
3. ุชุญูู ูู ุฃู ุฑูู ุงููุงุชู ุตุญูุญ ููุณุฌู ุนูู ูุงุชุณุงุจ
4. ุชุฃูุฏ ูู ุฑุตูุฏ ุงูุญุณุงุจ ุนูู SMS Mobile API

### ุงููุดููุฉ: ุฑูู ุงููุงุชู ุบูุฑ ุตุญูุญ
**ุงูุญู**: ุงููุธุงู ูููุณู ุฃุฑูุงู ุงูููุงุชู ุงูููุจูุฉ ุชููุงุฆูุงู:
- `0912345678` โ `218912345678`
- `218912345678` โ `218912345678`
- `912345678` โ `218912345678`

---

## ๐ ุงููููุงุช ุงููุนุฏูุฉ

| ุงูููู | ุงูุญุงูุฉ | ุงููุตู |
|------|--------|-------|
| `server/services/whatsapp.ts` | โ ุฌุฏูุฏ | ุฎุฏูุฉ ุฅุฑุณุงู ูุงุชุณุงุจ |
| `server/routers/customer.ts` | โ ูุญุฏุซ | ุชูุงูู OTP ูุน ูุงุชุณุงุจ |
| `.env.whatsapp.example` | โ ุฌุฏูุฏ | ูุซุงู ูููุชุบูุฑุงุช ุงูุจูุฆูุฉ |
| `.env` | โณ ูุญุชุงุฌ ุชุญุฏูุซ | ุฅุถุงูุฉ ุงููุชุบูุฑุงุช ุงูุจูุฆูุฉ |

---

## ๐ฏ ุงูุฎุทูุงุช ุงูุชุงููุฉ

1. โ ~~ุฅูุดุงุก ุฎุฏูุฉ WhatsApp~~
2. โ ~~ุงูุชูุงูู ูุน ูุธุงู OTP~~
3. โ ~~ุชูุซูู ุงูุงุณุชุฎุฏุงู~~
4. โณ **ุฅุถุงูุฉ ุงููุชุบูุฑุงุช ุงูุจูุฆูุฉ ุฅูู `.env`**
5. โณ **ุงุฎุชุจุงุฑ ุงูุฅุฑุณุงู ุงููุนูู**
6. โณ **ุงููุดุฑ ุฅูู ุงูุฅูุชุงุฌ**

---

## ๐ ุงูุฏุนู

- **ูุซุงุฆู SMS Mobile API**: https://smsmobileapi.com/
- **Dashboard**: https://dashboard.smsmobileapi.com/
- **Connect Phone**: https://smsmobileapi.com/connect/

---

**ุชู ุฅูุดุงุคู ุจูุงุณุทุฉ**: Antigravity AI  
**ุงูุชุงุฑูุฎ**: 2026-01-10  
**ุงูุฅุตุฏุงุฑ**: 1.0
